(function() { 
	// load the Cloud Module
	var Cloud = require('ti.cloud');
	// set .debug property to 'true' as we are in Development mode
	Cloud.debug = true;
	var loginUser = function(){
		Cloud.Users.login({
			login: 'com.fullsail.demoApp',
			password: '12345'
		}, function(e){
			// use .info method to view login info in the Console, if successful
			if (e.success){
				var user = e.users[0];
				Ti.API.info('Success!\n' + 
					'ACS User ID: ' + user.id + '\n' + 
					'ACS App sessionId: ' + Cloud.sessionId + '\n' + 
					'ACS App Username: ' + user.username);
			} else {
				alert((e.error && e.message) || JSON.stringify(e));
			}
		});
	}; // loginUser ends
	loginUser();
	// now your app is ready to access ACS network and data services
})();

Cloud.SocialIntegrations.externalAccountLogin({
    type: 'facebook',
    token: Ti.Facebook.accessToken
}, function (e) {
    if (e.success) {
        var user = e.users[0];
        alert('Success:\n' +
            'id: ' + user.id + '\n' +
            'first name: ' + user.first_name + '\n' +
            'last name: ' + user.last_name);
    } else {
        alert('Error:\n' +
            ((e.error && e.message) || JSON.stringify(e)));
    }
});

var win = Ti.UI.createWindow({
	title: "Capture the Moment",
	backgroundColor: "#FFF",
});

var holder = Ti.UI.createScrollView({
	backgroundColor: "red",
	top: 100,
	bottom: 0,
	width: Ti.FILL,
	layout: "horizontal",
	contentWidth: Ti.Platform.displayCaps.platformWidth
});

var cam = Ti.UI.createButton({
	title: "Camera",
	top: 20
});
var images = [];

cam.addEventListener("click", function(){
	
	Ti.Media.showCamera({	
		success:function(event){
			
			Ti.API.debug('Our type was:' + event.mediaType);
			if(event.mediaType == Ti.Media.MEDIA_TYPE_PHOTO){
				var imageView = Ti.UI.createImageView({
					width:win.width,
					height: win.height,
					image: event.media
				});
				images.push(imageView);
				for(i = 0; i < images.length; i++){
					var views = Ti.UI.createView({
						height: 200,
						width: 200,
						top: 20,
						left:20,
						backgroundColor: "red"
					});
				}
				views.add(imageView);
				holder.add(views);
			}else{
				alert("got the wrong type back = " + event.mediaType);
			}
		},
		cancel: function(){
			
		},
		error:function(error){
			
			var a = Ti.UI.createAlertDialog({
				title:'Camera'
			});
			if (error.code == Ti.Media.NO_CAMERA){
				a.setMessage('Please run this test on device');
			}else{
				a.setMessage('Unexpected error: ' + error.code);
			}
			a.show();
		},
		saveToPhotoGallery:true,
		allowEditing:true,
		mediaTypes:[Ti.Media.MEDIA_TYPE_VIDEO, Ti.Media.MEDIA_TYPE_PHOTO]
	});
		
});
console.log(images);
win.add(holder,cam);
win.open();
