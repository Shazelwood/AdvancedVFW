var currentWin = Ti.UI.currentWindow;
var Cloud = require('ti.cloud');


var scrollView = Titanium.UI.createScrollView({
	backgroundColor: "#FFF",
    contentWidth: 'auto',
    contentHeight: 'auto',
    top: 30,
    bottom: 0,
    showVerticalScrollIndicator: true,
    showHorizontalScrollIndicator: true
});
 
currentWin.add(scrollView);
 
var a = Titanium.UI.createAlertDialog({
    title:'Alert Test',
    message:'Hello World'
});
 
var contactUs = Titanium.UI.createLabel({
    color:'#001245',
    text:"",
    top:10,
    left:10,
    width:300,
    font:{fontSize:15,fontFamily:'Helvetica Neue'},
    height:'auto'
});
 
var firstName = Titanium.UI.createLabel({
    color:'#001245',
    text:'First',
    top:290,
    left:30,
    width:100,
    height:'auto'
});
 
var firstNameField = Titanium.UI.createTextField({
    hintText:'Shae',
    height:35,
    top:315,
    left:30,
    width:250,
    borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED
});
 
var lastName = Titanium.UI.createLabel({
    color:'#001245',
    text:'Last',
    top:355,
    left:30,
    width:200,
    height:'auto'
});
 
var lastNameField = Titanium.UI.createTextField({
    hintText:'Hazelwood',
    height:35,
    top:380,
    left:30,
    width:250,
    borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED
});
 
var email = Titanium.UI.createLabel({
    color:'#001245',
    text:'Email Address',
    top:420,
    left:30,
    width:200,
    height:'auto'
});
 
var emailField = Titanium.UI.createTextField({
    hintText:'email@',
    height:35,
    top:445,
    left:30,
    width:250,
    borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED,
    keyboardType:Titanium.UI.KEYBOARD_EMAIL,
    returnKeyType:Titanium.UI.RETURNKEY_DONE
});
 
var username = Titanium.UI.createLabel({
    color:'#001245',
    text:'username',
    top:485,
    left:30,
    width:200,
    height:'auto'
});
 
var usernameField = Titanium.UI.createTextField({
    hintText:"Shazelwood1995",
    height:35,
    top:510,
    left:30,
    width:250,
    blur:true,
    borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED
});
 
var password = Titanium.UI.createLabel({
    color:'#001245',
    text:'Password',
    top:550,
    left:30,
    width:200,
    height:'auto'
});
 
var passwordField = Titanium.UI.createTextField({
    hintText:"**********",
    height:35,
    top:575,
    left:30,
    width:250,
    blur:true,
    borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED
});
 
var passwordCheck = Titanium.UI.createLabel({
    color:'#001245',
    text:'Re-Type Password',
    top:615,
    left:30,
    width:200,
    height:'auto'
});
 
var passwordCheckField = Titanium.UI.createTextField({
    hintText:"*********",
    height:35,
    top:640,
    left:30,
    width:250,
    blur:true,
    borderStyle:Titanium.UI.INPUT_BORDERSTYLE_ROUNDED
});

var profilePic = Ti.UI.createImageView({
	top: 120,
	left: 30, 
	width: 150,
	height: 150,
	borderWeight: 30,
	backgroundColor: "001245",
	image: "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBw8NDw8QDw8OEA4MDw8NEA8QDw8ODxAPFBIXFiAUFBQYHSggGBolHBQTITIhJykrLi4uFx8zODMuNygtLisBCgoKBQUFDgUFDisZExkrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrK//AABEIAMwAzAMBIgACEQEDEQH/xAAaAAEAAwEBAQAAAAAAAAAAAAAABAUGAwEC/8QANBABAAIBAQUECAYCAwAAAAAAAAECAxEEBSExUSJBYXESEzKBobHB4QZCYnKR0SNSM5Ki/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/AN6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACdsO7b5eM9mnWec+UAhJGLYct+WO2nWezHxaLZthx4vZrGv8AtPG38pIM3G583Sv/AGfN905o/LE+Uw0wDH5cNqe1W1fOJhzbK1YmNJiJjpPGFbtm56W44+xbp+Wf6Bnx0zYbY7TW0TEx8fJzAAAAAAAAAAAAAAABI2DZpzXivdztPSoJm6N3es7d47Eco/2n+l/EaPKVisREcIiNIh9AAAAAAAj7Zslc1dLc45W74ll9ow2x2mto4x8Y6tgrt87J6ynpRHapx8698AzgAAAAAAAAAAAAAC/3Bh0pN++86R+2PvqoGs2Cno4scfpj4gkAAAAAAAAPJegMnt+H1eS9e6J1jynijrX8QU0yVnrX5SqgAAAAAAAAAAAAGw2f2Kftr8mPardmT0sOOfDSfOOAJQAAAAAAAAAKP8Rc8flZTrPf2TXLEf6V0988VYAAAAAAAAAAAAAuvw/n9rHP74+U/RSumz5Zx2raOdZ18/AGwHLZs9clYtXlPwno6gAAAAAAPm9oiJmeURrL6U+/Ns0j1VZ4z7XhHQFRtOX1l7Wn80zPucgAAAAAAAAAAAAAABM3dt04bdaT7VfrDSYM1clYtWdYlkIjXlxmVtu3Yc9Zi0W9XE84njrHjUF6PIegAAAjbbjyXrpjvFZ8Y5+/uBH3lvKMUTWuk5J/ivn/AEztrTMzMzrMzrM+LttOy5MU9usxr384n3uAAAAAAAAAAAAAAACVsWw3zTw4VjnaeX3l13Zu+c0+lbhjiffbwho8dIrERWIiI5RAI+ybDjwx2Y1t32njP2SgAAAAAAB82rFo0mImJ7p4wqNv3Pzti4fo1+UrkBjLRMTMTGkxwmHjS7y3dGaNY0jJHKevhLOZKTWZiY0mJ0mAfIAAAAAAAAACXu7Y5zW6UrxtP0RsdJtMViNZtOkQ1exbNGGkVj3z1nqDrjpFYiIjSI4RHR9AAAAAAAAAAAArt7bB62vpVj/JX/1HRYgMY8Wu+9j9C3rKx2bzpbwt91UAAAAAAAD2sazERzmdIBcbg2XWZyTHLs18++V247Lh9XStY/LGnvdgAAAAAAAAAAAAAAc9owxkras8rRp5eLJZcc0tas86zMS2Kh3/AINLVvHK/CfOPt8gVIAAAAACdubD6eavSnb/AIQV3+HcfDJbrMVj5/0C5AAAAAAAAAAAAAAAAQ97YfTw2617Ue5MeWjWJieUxoDGD6yV9GZiedZmJ84l8gAAAANJuOumGP1WtP0+jNtRur/hx+X1BMAAAAAAAAAAAAAAAAB4DLbzrpmyeNtf5jVFT99x/mt5V+SAAAD/2Q=="
});

var createBTN = Ti.UI.createButton({
	top: 700, 
	title: "Create User"
});

profilePic.addEventListener("click", function(){
	var dialog = Titanium.UI.createOptionDialog({
    title: 'Choose an image source...',
    options: ['Camera','Photo Gallery', 'Cancel'],
    cancel:2
	});
	dialog.addEventListener('click', function(e) {
	    if(e.index == 0)
	    {
	        Titanium.Media.showCamera({
	            success:function(event)
	            {
	                var image = event.media; 
	                if(event.mediaType == Ti.Media.MEDIA_TYPE_PHOTO)
	                {
	                    Ti.App.Properties.setString("image", image.nativePath);
	                    // var imageView = Ti.UI.createImageView({
	                    	// height: 'auto',
	                    	// width: 'auto',
							// image: image
						// });
						profilePic.image = image;
	                }
	            },
	            cancel:function()
	            {
	                //do somehting if user cancels operation
	            },
	            error:function(error)
	            {
	                var a = Titanium.UI.createAlertDialog({title:'Camera'});
	                if (error.code == Titanium.Media.NO_CAMERA)
	                {
	                    a.setMessage('Device does not have camera');
	                }
	                else
	                {
	                    a.setMessage('Unexpected error: ' + error.code);
	                }
	                a.show();
	            },
	            allowImageEditing:true,
	            saveToPhotoGallery:true
	        });
	    }
	    else if(e.index == 1)
	    {
	        Titanium.Media.openPhotoGallery({
	            success:function(event)
	            {
	                var image = event.media; 
	                if(event.mediaType == Ti.Media.MEDIA_TYPE_PHOTO)
	                {
	                   Ti.App.Properties.setString("image", image.nativePath);
	                   // var imageView = Ti.UI.createImageView({
	                    	// height: 'auto',
	                    	// width: 'auto',
							// image: image
						// });
						// profilePic.add(imageView);
						profilePic.image = image; 
	                }   
	            },
	            cancel:function()
	            {
	                
	            }
	        });
	    }
	    else
	    {
	        //cancel was tapped
	        //user opted not to choose a photo
	    }
	});
	dialog.show();
});
createBTN.addEventListener("click", function(){
	Cloud.Users.create({
		username: usernameField.value,
	    email: emailField.value,
	    first_name: firstNameField.value,
	    last_name: lastNameField.value,
	    password: passwordField.value,
	    password_confirmation: passwordCheckField.value,
	    photo: profilePic.image
	    
	}, 
	function (e) {
	    if (e.success) {
	        var user = e.users[0];
	        alert('Success:\n' +
	            'id: ' + user.id + '\n' +
	            'sessionId: ' + Cloud.sessionId + '\n' +
	            'first name: ' + user.first_name + '\n' +
	            'last name: ' + user.last_name);
	    } else {
	        alert('Error:\n' +
	            ((e.error && e.message) || JSON.stringify(e)));
	    }
	});
});



scrollView.add(createBTN);
scrollView.add(contactUs); 
scrollView.add(passwordCheckField);
scrollView.add(passwordCheck);
scrollView.add(passwordField);
scrollView.add(password);
scrollView.add(usernameField);
scrollView.add(username);
scrollView.add(emailField);
scrollView.add(email);
scrollView.add(lastNameField);
scrollView.add(lastName);
scrollView.add(firstNameField);
scrollView.add(firstName); 
scrollView.add(profilePic);